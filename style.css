// 유저 정보 (가정)
let currentUser = {
    id: "user01",
    position: "매니저", // '책임 매니저' 등으로 테스트 가능
    nickname: "익명 " + Math.floor(Math.random() * 90 + 10) // 10~99 랜덤 숫자
};

// 게시판 데이터 (임시 저장소)
let posts = [];

// 게시판 로드 함수 업데이트
function loadBoard(name) {
    // 권한 체크
    if (name === "책임 라운지" && currentUser.position !== "책임 매니저") {
        alert("책임 매니저만 접근 가능한 게시판입니다.");
        return;
    }
    if (name === "매니저 라운지" && currentUser.position !== "매니저") {
        alert("매니저만 접근 가능한 게시판입니다.");
        return;
    }

    // 화면 전환
    document.getElementById('homeView').style.display = 'none';
    document.getElementById('boardView').style.display = 'block';
    document.getElementById('currentBoardTitle').innerText = name;
    
    // 대나무 라운지는 글쓰기 버튼 숨김 (댓글 전용이므로)
    document.getElementById('writeBtn').style.display = (name === "대나무 라운지") ? "none" : "block";

    renderPosts(name);
    toggleMenu();
}

// 글쓰기 모달 제어
function openPostModal() {
    document.getElementById('postModal').style.display = 'block';
}

function closePostModal() {
    document.getElementById('postModal').style.display = 'none';
}

// 글 저장 (임시)
function savePost() {
    const title = document.getElementById('postTitle').value;
    const content = document.getElementById('postContent').value;
    const boardName = document.getElementById('currentBoardTitle').innerText;

    if (!title || !content) {
        alert("제목과 내용을 모두 입력해주세요.");
        return;
    }

    const newPost = {
        board: boardName,
        title: title,
        content: content,
        author: currentUser.nickname,
        date: new Date().toLocaleDateString()
    };

    posts.unshift(newPost); // 최신글이 위로
    renderPosts(boardName);
    closePostModal();
    
    // 입력창 초기화
    document.getElementById('postTitle').value = "";
    document.getElementById('postContent').value = "";
}

// 글 목록 렌더링
function renderPosts(boardName) {
    const listDiv = document.getElementById('postList');
    const filteredPosts = posts.filter(p => p.board === boardName);
    
    listDiv.innerHTML = filteredPosts.map(p => `
        <div class="post-item">
            <h4>${p.title}</h4>
            <div class="post-info">${p.author} | ${p.date}</div>
        </div>
    `).join('');
}
